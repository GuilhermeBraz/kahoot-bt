<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kahoot-BT MVP</title>
    <style>
      :root {
        --bg: #0f172a;
        --card: #111827;
        --text: #e5e7eb;
        --muted: #9ca3af;
        --accent: #0ea5e9;
        --warn: #f59e0b;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
        background: radial-gradient(1200px 700px at 20% 0%, #1e293b 0%, var(--bg) 55%);
        color: var(--text);
      }
      .wrap {
        max-width: 920px;
        margin: 24px auto;
        padding: 0 16px;
        display: grid;
        gap: 12px;
      }
      .card {
        border: 1px solid #1f2937;
        background: color-mix(in oklab, var(--card) 92%, #000 8%);
        border-radius: 14px;
        padding: 14px;
      }
      h1, h2, h3 { margin: 0 0 8px; }
      .grid { display: grid; gap: 8px; }
      .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      input, button {
        width: 100%;
        border-radius: 10px;
        border: 1px solid #374151;
        background: #0b1220;
        color: var(--text);
        padding: 10px 12px;
      }
      button { cursor: pointer; }
      button:hover { border-color: var(--accent); }
      .active-mode {
        border-color: var(--accent);
        box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--accent) 70%, white 30%);
      }
      .muted { color: var(--muted); font-size: 14px; }
      .warn { color: var(--warn); }
      .hidden { display: none; }
      .answer-btn { text-align: left; }
      .pill {
        display: inline-block;
        font-size: 12px;
        border: 1px solid #374151;
        border-radius: 999px;
        padding: 3px 8px;
      }
      ol { margin: 8px 0 0; padding-left: 22px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <h1>Kahoot-BT • MVP</h1>
        <p class="muted">Escolha seu modo e entre na sala.</p>
      </div>

      <div class="card grid" id="mode-card">
        <h2>1) Escolha o modo</h2>
        <div class="grid grid-3">
          <button id="modeOrganizerBtn">Organizador (criar sala)</button>
          <button id="modeParticipantBtn">Participante (join)</button>
          <button id="modeDebugBtn">Debug (ver tudo)</button>
        </div>
        <p class="muted" id="modeHint">Selecione um modo para continuar.</p>
      </div>

      <div class="card grid hidden" id="join-card">
        <h2>2) Conexão</h2>
        <input id="apiUrl" placeholder="API URL (ex: http://localhost:3333)" />

        <div id="create-room-wrap" class="hidden grid grid-2">
          <input id="generatedRoomId" placeholder="Room ID gerado" readonly />
          <button id="generateRoomBtn">Gerar Room ID</button>
        </div>

        <input id="roomId" placeholder="Room ID" />
        <input id="username" placeholder="Username" />

        <button id="joinBtn">Conectar</button>
        <p class="muted" id="joinHint"></p>
      </div>

      <div class="card hidden" id="session-card">
        <h2>Sessão</h2>
        <p id="sessionInfo" class="muted"></p>
        <span class="pill" id="modeTag">modo: -</span>
        <span class="pill" id="roomStatus">room status: waiting</span>
        <span class="pill" id="questionSourceTag">questions: default (1)</span>
      </div>

      <div class="card hidden" id="host-card">
        <h2>Controles do Organizador</h2>
        <div class="grid grid-2">
          <button id="startBtn">Iniciar jogo</button>
          <button id="nextBtn">Próxima pergunta</button>
        </div>
      </div>

      <div class="card hidden" id="question-bank-card">
        <h2>Banco de Perguntas (Organizador)</h2>
        <p class="muted">Você pode criar na hora ou importar CSV. O servidor confirma a origem ativa.</p>

        <div class="grid">
          <h3>Adicionar pergunta manual</h3>
          <input id="qTitle" placeholder="Enunciado da pergunta" />
          <div class="grid grid-2">
            <input id="qA" placeholder="Alternativa A" />
            <input id="qB" placeholder="Alternativa B" />
            <input id="qC" placeholder="Alternativa C" />
            <input id="qD" placeholder="Alternativa D" />
          </div>
          <input id="qCorrectIndex" type="number" min="1" max="4" value="1" placeholder="Resposta correta (1-4)" />
          <button id="addManualQuestionBtn">Adicionar pergunta ao rascunho</button>
        </div>

        <div class="grid">
          <h3>Importar CSV</h3>
          <p class="muted">Formato: title,optionA,optionB,optionC,optionD,correctIndex(1-4)</p>
          <textarea id="csvInput" rows="6" style="width: 100%; border-radius: 10px; border: 1px solid #374151; background: #0b1220; color: var(--text); padding: 10px 12px;"></textarea>
          <input id="csvFileInput" type="file" accept=".csv,text/csv" />
          <button id="parseCsvBtn">Carregar CSV no rascunho</button>
        </div>

        <div class="grid">
          <h3>Rascunho atual</h3>
          <ol id="draftQuestions"></ol>
          <div class="grid grid-2">
            <button id="publishManualBtn">Publicar rascunho como Manual</button>
            <button id="publishCsvBtn">Publicar rascunho como CSV</button>
          </div>
          <button id="clearDraftBtn">Limpar rascunho</button>
          <p class="muted" id="questionBankAck"></p>
        </div>
      </div>

      <div class="card hidden" id="question-card">
        <h2>Pergunta atual</h2>
        <h3 id="questionTitle">-</h3>
        <p class="muted" id="timer">Tempo restante: -</p>
        <div class="grid" id="answers"></div>
        <p id="answerAck" class="muted"></p>
      </div>

      <div class="card hidden" id="round-card">
        <h2>Resultado da rodada</h2>
        <p id="correctAnswer" class="muted">Correta: -</p>
      </div>

      <div class="card hidden" id="rank-card">
        <h2>Leaderboard</h2>
        <ol id="ranking"></ol>
      </div>

      <div class="card hidden" id="logs-card">
        <h2>Logs (debug)</h2>
        <pre id="logs" style="white-space: pre-wrap; margin: 0"></pre>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
